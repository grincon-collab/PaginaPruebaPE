<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Escenario BÃ¡sico - Predictive Engagement</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #f5f5f5;
            min-height: 100vh;
            padding: 20px;
        }

        .header {
            background: white;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            margin-bottom: 30px;
            border-radius: 10px;
        }

        .header h1 {
            color: #667eea;
            margin-bottom: 10px;
        }

        .header p {
            color: #666;
        }

        .btn-back {
            display: inline-block;
            background: #667eea;
            color: white;
            padding: 12px 24px;
            border-radius: 8px;
            text-decoration: none;
            margin-top: 15px;
            transition: all 0.3s ease;
            border: none;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
        }

        .btn-back:hover {
            background: #5568d3;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .tracking-info {
            background: white;
            padding: 25px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }

        .tracking-info h2 {
            color: #667eea;
            margin-bottom: 15px;
        }

        .tracking-status {
            display: inline-block;
            background: #d4edda;
            color: #155724;
            padding: 8px 16px;
            border-radius: 5px;
            font-weight: 600;
            margin-bottom: 20px;
        }

        .tracking-list {
            list-style: none;
            padding: 0;
        }

        .tracking-list li {
            padding: 10px 0;
            border-bottom: 1px solid #eee;
        }

        .tracking-list li:last-child {
            border-bottom: none;
        }

        .tracking-list strong {
            color: #667eea;
        }

        .content-area {
            background: white;
            padding: 40px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            text-align: center;
        }

        .content-area h2 {
            color: #333;
            margin-bottom: 20px;
        }

        .content-area p {
            color: #666;
            line-height: 1.6;
        }

        .debug-panel {
            background: #2d3748;
            color: #e2e8f0;
            padding: 20px;
            border-radius: 10px;
            margin-top: 20px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
        }

        .debug-panel h3 {
            color: #48bb78;
            margin-bottom: 15px;
        }

        .debug-info {
            background: #1a202c;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 10px;
        }

        .debug-label {
            color: #63b3ed;
            font-weight: bold;
        }

        .debug-value {
            color: #f6e05e;
        }

        .debug-success {
            color: #48bb78;
        }

        .debug-error {
            color: #f56565;
        }

        .btn-refresh {
            background: #48bb78;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: 600;
            margin-top: 10px;
        }

        .btn-refresh:hover {
            background: #38a169;
        }

        .simulation-panel {
            background: white;
            padding: 25px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            margin-top: 20px;
        }

        .simulation-panel h2 {
            color: #667eea;
            margin-bottom: 20px;
        }

        .event-card {
            background: #f8f9fa;
            border-left: 4px solid #667eea;
            padding: 20px;
            margin-bottom: 15px;
            border-radius: 5px;
        }

        .event-title {
            font-size: 1.2em;
            font-weight: 600;
            color: #333;
            margin-bottom: 8px;
        }

        .event-description {
            color: #666;
            margin-bottom: 15px;
            font-size: 0.95em;
        }

        .btn-simulate {
            background: #667eea;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: 600;
            font-size: 14px;
            transition: all 0.3s ease;
        }

        .btn-simulate:hover {
            background: #5568d3;
            transform: translateY(-2px);
        }

        .btn-simulate:active {
            transform: translateY(0);
        }

        .event-status {
            display: inline-block;
            margin-left: 10px;
            padding: 5px 10px;
            border-radius: 3px;
            font-size: 12px;
            font-weight: 600;
        }

        .status-success {
            background: #d4edda;
            color: #155724;
        }

        .form-test {
            background: #fff;
            padding: 20px;
            border: 2px dashed #667eea;
            border-radius: 8px;
            margin-top: 15px;
        }

        .form-test input {
            width: 100%;
            padding: 10px;
            border: 2px solid #ddd;
            border-radius: 5px;
            margin-bottom: 10px;
            font-size: 14px;
        }

        .form-test input:focus {
            outline: none;
            border-color: #667eea;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>ğŸ“„ Escenario BÃ¡sico</h1>
        <p>Tracking fundamental de Predictive Engagement</p>
        <button class="btn-back" onclick="window.location.href='index.html'">â† Volver al MenÃº Principal</button>
    </div>

    <div class="tracking-info">
        <h2>ğŸ“¡ Estado del Tracking</h2>
        <div class="tracking-status">âœ… Fragmento Cargado</div>
        
        <h3 style="margin-top: 20px; margin-bottom: 10px; color: #333;">Eventos Activos:</h3>
        <ul class="tracking-list">
            <li><strong>ac('pageview')</strong> - Registro de vista de pÃ¡gina</li>
            <li><strong>autotrackUrlChange</strong> - DetecciÃ³n automÃ¡tica de cambios de URL</li>
            <li><strong>forms:track</strong> - Captura de datos de formularios (envÃ­o y abandono)</li>
        </ul>

        <div style="margin-top: 20px; padding: 15px; background: #e7f3ff; border-left: 4px solid #667eea; border-radius: 5px;">
            <strong>ğŸ’¡ Tip:</strong> Abre la consola del navegador (F12) para ver los eventos de tracking en tiempo real.
        </div>
    </div>

    <div class="content-area">
        <h2>Ãrea de Contenido</h2>
        <p>Esta es una pÃ¡gina en blanco para probar el tracking bÃ¡sico de Predictive Engagement.</p>
        <p style="margin-top: 15px;">El fragmento de tracking se ejecuta automÃ¡ticamente al cargar la pÃ¡gina.</p>
    </div>

    <!-- Panel de SimulaciÃ³n de Eventos -->
    <div class="simulation-panel">
        <h2>ğŸ® Simulador de Eventos</h2>
        <p style="color: #666; margin-bottom: 20px;">Usa estos botones para disparar eventos manualmente y verlos aparecer en el Journey de Genesys:</p>

        <!-- Evento 1: Pageview -->
        <div class="event-card">
            <div class="event-title">ğŸ“„ Evento: Pageview</div>
            <div class="event-description">
                Registra una vista de pÃ¡gina adicional. Ãštil para simular navegaciÃ³n entre secciones.
            </div>
            <button class="btn-simulate" onclick="simularPageview()">
                ğŸ”µ Disparar Pageview
            </button>
            <span id="pageviewStatus" class="event-status"></span>
        </div>

        <!-- Evento 2: URL Change -->
        <div class="event-card">
            <div class="event-title">ğŸ”— Evento: URL Change</div>
            <div class="event-description">
                Simula un cambio de URL sin recargar la pÃ¡gina (Ãºtil para SPA - Single Page Applications).
            </div>
            <button class="btn-simulate" onclick="simularUrlChange()">
                ğŸŸ¢ Disparar URL Change
            </button>
            <span id="urlChangeStatus" class="event-status"></span>
        </div>

        <!-- Evento 3: Form Submit -->
        <div class="event-card">
            <div class="event-title">ğŸ“ Evento: Form Submit</div>
            <div class="event-description">
                Simula el envÃ­o de un formulario. El tracking captura los datos automÃ¡ticamente.
            </div>
            <div class="form-test">
                <form id="testForm" name="testForm">
                    <input type="text" name="nombre" placeholder="Nombre" value="Juan PÃ©rez">
                    <input type="email" name="email" placeholder="Email" value="juan@ejemplo.com">
                    <input type="tel" name="telefono" placeholder="TelÃ©fono" value="555-1234">
                    <button type="submit" class="btn-simulate" style="width: 100%;">
                        ğŸŸ¡ Enviar Formulario
                    </button>
                </form>
            </div>
            <span id="formStatus" class="event-status"></span>
        </div>

        <!-- Evento 4: Form Abandon -->
        <div class="event-card">
            <div class="event-title">ğŸšª Evento: Form Abandon</div>
            <div class="event-description">
                Simula el abandono de un formulario (usuario llena campos pero no envÃ­a).
            </div>
            <button class="btn-simulate" onclick="simularFormAbandon()">
                ğŸ”´ Simular Abandono de Formulario
            </button>
            <span id="abandonStatus" class="event-status"></span>
        </div>

        <!-- Evento Custom -->
        <div class="event-card">
            <div class="event-title">â­ Evento: Custom Event</div>
            <div class="event-description">
                EnvÃ­a un evento personalizado con atributos especÃ­ficos.
            </div>
            <button class="btn-simulate" onclick="simularCustomEvent()">
                ğŸŸ£ Disparar Evento Personalizado
            </button>
            <span id="customStatus" class="event-status"></span>
        </div>
    </div>

    <!-- Panel de Debug -->
    <div style="margin-top: 20px;">
        <div class="debug-panel">
            <h3>ğŸ” Panel de Debugging - Estado del Tracking</h3>
            
            <div class="debug-info">
                <div class="debug-label">Estado del SDK:</div>
                <div id="sdkStatus" class="debug-value">Verificando...</div>
            </div>

            <div class="debug-info">
                <div class="debug-label">Session ID:</div>
                <div id="sessionId" class="debug-value">Cargando...</div>
            </div>

            <div class="debug-info">
                <div class="debug-label">Deployment ID:</div>
                <div id="deploymentId" class="debug-value">9bb35534-a7d5-45db-b818-dab73775234a</div>
            </div>

            <div class="debug-info">
                <div class="debug-label">RegiÃ³n:</div>
                <div id="region" class="debug-value">use1 (US East)</div>
            </div>

            <div class="debug-info">
                <div class="debug-label">Eventos Rastreados:</div>
                <div id="eventsTracked" class="debug-value">0</div>
            </div>

            <div class="debug-info">
                <div class="debug-label">Ãšltima Actividad:</div>
                <div id="lastActivity" class="debug-value">-</div>
            </div>

            <button class="btn-refresh" onclick="refreshDebugInfo()">ğŸ”„ Actualizar Info</button>
        </div>
    </div>
    </div>

    <!-- ============================================== -->
    <!-- TRACKING PREDICTIVE ENGAGEMENT                 -->
    <!-- ============================================== -->
    <script src="tracking-basico.js"></script>

    <!-- ============================================== -->
    <!-- SIMULACIÃ“N DE EVENTOS                          -->
    <!-- ============================================== -->
    <script>
        // FunciÃ³n para mostrar estado del evento
        function mostrarEstado(elementId, mensaje) {
            const statusElement = document.getElementById(elementId);
            statusElement.textContent = mensaje;
            statusElement.className = 'event-status status-success';
            setTimeout(() => {
                statusElement.textContent = '';
                statusElement.className = 'event-status';
            }, 3000);
        }

        // 1. Simular Pageview
        function simularPageview() {
            try {
                ac('pageview', {
                    location: window.location.href,
                    title: document.title + ' - Pageview Simulado',
                    customAttributes: {
                        simulado: true,
                        timestamp: new Date().toISOString()
                    }
                });
                mostrarEstado('pageviewStatus', 'âœ… Pageview enviado!');
                console.log('ğŸ“„ Pageview simulado enviado');
            } catch (e) {
                console.error('Error al simular pageview:', e);
                mostrarEstado('pageviewStatus', 'âŒ Error');
            }
        }

        // 2. Simular URL Change
        function simularUrlChange() {
            try {
                const newUrl = window.location.href + '#seccion-' + Math.floor(Math.random() * 1000);
                window.history.pushState({}, '', newUrl);
                
                ac('pageview', {
                    location: newUrl,
                    title: document.title + ' (URL Change)',
                    customAttributes: {
                        eventType: 'urlChange',
                        simulado: true,
                        timestamp: new Date().toISOString()
                    }
                });
                
                mostrarEstado('urlChangeStatus', 'âœ… URL Change enviado!');
                console.log('ğŸ”— URL Change simulado:', newUrl);
            } catch (e) {
                console.error('Error al simular URL change:', e);
                mostrarEstado('urlChangeStatus', 'âŒ Error');
            }
        }

        // 3. Manejar envÃ­o real del formulario
        document.getElementById('testForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const formData = new FormData(e.target);
            const data = {};
            formData.forEach((value, key) => {
                data[key] = value;
            });
            
            mostrarEstado('formStatus', 'âœ… Formulario enviado! (Datos capturados por tracking)');
            console.log('ğŸ“ Formulario enviado:', data);
            console.log('âœ… El tracking forms:track capturÃ³ los datos automÃ¡ticamente');
        });

        // 4. Simular abandono de formulario
        function simularFormAbandon() {
            try {
                // Crear un formulario temporal y abandonarlo
                const tempForm = document.createElement('form');
                tempForm.id = 'tempForm';
                tempForm.style.display = 'none';
                
                const input1 = document.createElement('input');
                input1.name = 'campo1';
                input1.value = 'Valor de prueba';
                
                const input2 = document.createElement('input');
                input2.name = 'campo2';
                input2.value = 'Otro valor';
                
                tempForm.appendChild(input1);
                tempForm.appendChild(input2);
                document.body.appendChild(tempForm);
                
                // Disparar evento de abandono
                ac('record', 'formAbandon', {
                    formName: 'tempForm',
                    fieldsCompleted: 2,
                    simulado: true,
                    timestamp: new Date().toISOString()
                });
                
                // Limpiar
                setTimeout(() => document.body.removeChild(tempForm), 100);
                
                mostrarEstado('abandonStatus', 'âœ… Abandono de formulario enviado!');
                console.log('ğŸšª Abandono de formulario simulado');
            } catch (e) {
                console.error('Error al simular abandono:', e);
                mostrarEstado('abandonStatus', 'âŒ Error');
            }
        }

        // 5. Simular evento personalizado
        function simularCustomEvent() {
            try {
                ac('record', 'eventoPersonalizado', {
                    categoria: 'simulacion',
                    accion: 'test_manual',
                    valor: Math.floor(Math.random() * 100),
                    simulado: true,
                    timestamp: new Date().toISOString(),
                    userAgent: navigator.userAgent
                });
                
                mostrarEstado('customStatus', 'âœ… Evento personalizado enviado!');
                console.log('â­ Evento personalizado simulado');
            } catch (e) {
                console.error('Error al simular evento personalizado:', e);
                mostrarEstado('customStatus', 'âŒ Error');
            }
        }

        console.log('ğŸ® Simulador de eventos cargado');
        console.log('ğŸ’¡ Usa los botones en la pÃ¡gina para disparar eventos manualmente');
    </script>

    <!-- ============================================== -->
    <!-- DEBUGGING Y MONITOREO                          -->
    <!-- ============================================== -->
    <script>
        let eventCount = 0;

        // FunciÃ³n para actualizar informaciÃ³n de debug
        function refreshDebugInfo() {
            try {
                // Verificar si el SDK estÃ¡ cargado
                if (typeof ac !== 'undefined') {
                    document.getElementById('sdkStatus').innerHTML = '<span class="debug-success">âœ… SDK Cargado</span>';
                    
                    // Intentar obtener session ID
                    ac('get', 'attributes', function(data) {
                        if (data && data.sessionId) {
                            document.getElementById('sessionId').textContent = data.sessionId;
                        } else {
                            document.getElementById('sessionId').textContent = 'Esperando inicializaciÃ³n...';
                        }
                    });
                } else {
                    document.getElementById('sdkStatus').innerHTML = '<span class="debug-error">âŒ SDK No Cargado</span>';
                }

                document.getElementById('lastActivity').textContent = new Date().toLocaleTimeString();
            } catch (e) {
                console.error('Error al actualizar debug info:', e);
                document.getElementById('sdkStatus').innerHTML = '<span class="debug-error">âŒ Error: ' + e.message + '</span>';
            }
        }

        // Interceptar llamadas al SDK para contar eventos
        if (typeof ac !== 'undefined') {
            const originalAc = ac;
            window.ac = function() {
                const command = arguments[0];
                if (command === 'pageview' || command === 'record' || command === 'event') {
                    eventCount++;
                    document.getElementById('eventsTracked').textContent = eventCount;
                    console.log('ğŸ“Š Evento rastreado:', command, arguments[1]);
                }
                return originalAc.apply(this, arguments);
            };
        }

        // Actualizar info cada 3 segundos
        setInterval(refreshDebugInfo, 3000);

        // Primera actualizaciÃ³n despuÃ©s de 2 segundos (dar tiempo al SDK)
        setTimeout(function() {
            refreshDebugInfo();
            
            // Mostrar informaciÃ³n adicional en consola
            console.log('â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•');
            console.log('ğŸ“Š INFORMACIÃ“N DE DEBUGGING');
            console.log('â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•');
            console.log('Deployment ID: 9bb35534-a7d5-45db-b818-dab73775234a');
            console.log('RegiÃ³n: use1');
            console.log('PÃ¡gina actual:', window.location.href);
            console.log('â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•');
            console.log('ğŸ’¡ Para verificar si la acciÃ³n estÃ¡ lista:');
            console.log('1. Verifica que la acciÃ³n estÃ© publicada en Genesys');
            console.log('2. Verifica que el outcome/segmento estÃ© correctamente configurado');
            console.log('3. Verifica que el Journey estÃ© en estado "Active"');
            console.log('4. Espera 1-2 minutos despuÃ©s de publicar cambios');
            console.log('â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•');
        }, 2000);
    </script>
</body>
</html>
